import{i as t,a as e}from"./ipcRenderer-b6d714b6.js";import{g as l,i as a,m as o,u as i,a as n,h as s,s as u,_ as r,r as h,o as p,c as d,w as c,f as m,n as y,d as b,t as v,F as f,j as g,k as x}from"./index-0e1536f0.js";let k;let w=l({},{title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1});function C(t){return a?new Promise(((e,a)=>{k||function(){const t={setup(){const{state:t,toggle:e}=i();return()=>n(u,s(t,{"onUpdate:show":e}),null)}};({instance:k}=o(t))}(),k.open(l({},w,t,{callback:t=>{("confirm"===t?e:a)(t)}}))})):Promise.resolve(void 0)}const S={class:"box"},O={class:"flex-box"},A={class:"flex-box"},B={style:{color:"red","font-weight":"bold"}},D={class:"flex-box"};const T={id:"app-base-db"},_={class:"header"},N={class:"header-title"},q={style:{display:"flex","align-items":"center",margin:"28px 0px"}},L={class:"card-warpper"},$={class:"operation-box"},z={class:"operation-box"},U={style:{padding:"24px"}},H={style:{padding:"24px"}},V={style:{"margin-top":"24px"}},j={style:{padding:"24px"}},I={style:{padding:"24px"}};const E=r({components:{itemCard:r({props:{ballNum:{type:Number,default:0},shengxiao:{type:Number,default:0},sum:{type:Number,default:0},color:{type:String,default:""}},methods:{openDialog(t){let e={ballNum:this.ballNum,operation:t};this.$emit("openDialog",e)},openDetail(){this.$emit("openDetail",this.ballNum,this.sum)},getStyle(){let t="#f50";return"blue"===this.color&&(t="#1989fa"),"green"===this.color&&(t="#07c160"),{"background-color":t,color:"white",width:"150px","font-weight":"bold","font-size":"medium"}}}},[["render",function(t,e,l,a,o,i){const s=h("a-button"),u=h("van-tag"),r=h("van-icon"),f=h("van-button"),g=h("a-card");return p(),d("div",S,[n(g,{hoverable:"",style:{width:"200px","border-radius":"15%"}},{default:c((()=>[m("div",null,[n(s,{style:y(i.getStyle()),onClick:i.openDetail},{default:c((()=>[b(v(l.ballNum),1)])),_:1},8,["style","onClick"])]),m("div",O,[n(u,{plain:"",type:"primary",size:"large"},{default:c((()=>[b("生肖")])),_:1}),m("span",null,v(l.shengxiao),1)]),m("div",A,[n(u,{plain:"",type:"primary",size:"large"},{default:c((()=>[b("总计")])),_:1}),m("span",B,v(l.sum)+" / "+v(47*l.sum),1)]),m("div",D,[n(f,{plain:"",size:"small",style:{"font-size":"16px",flex:"1"},type:"success",onClick:e[0]||(e[0]=t=>i.openDialog("add"))},{default:c((()=>[n(r,{name:"plus"})])),_:1}),n(f,{plain:"",size:"small",style:{"margin-left":"12px","font-size":"16px",flex:"1"},type:"danger",onClick:e[1]||(e[1]=t=>i.openDialog("sub"))},{default:c((()=>[n(r,{name:"minus"})])),_:1})])])),_:1})])}],["__scopeId","data-v-98ac3491"]])},data:()=>({all_list:["空"],sum:100,shengxiao:"zhu",ballNum:99,showAddSub:!1,showDetail:!1,showBatch:!1,showBatch2:!1,showType:!1,showHistory:!1,amount:"",amountText:"",period:"",numCheckValue:"",numOptions:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49"],shengxiaoArr:[],numCheckAmount:"",shengxiaoOptions:[{value:"龙"},{value:"兔"},{value:"虎"},{value:"牛"},{value:"鼠"},{value:"猪"},{value:"狗"},{value:"鸡"},{value:"猴"},{value:"羊"},{value:"马"},{value:"蛇"}],typeOptions:[{value:"龙"},{value:"兔"},{value:"虎"},{value:"牛"},{value:"鼠"},{value:"猪"},{value:"狗"},{value:"鸡"},{value:"猴"},{value:"羊"},{value:"马"},{value:"蛇"}],allSum:0,allList:[],operationBall:{ballNum:"",amount:"",operation:""},detailList:[],amountStr:"",typeStr:"",addType:[],typeAmount:"",historyDataList:[],columns:[{title:"操作详情",dataIndex:"desc",key:"desc",width:500},{title:"操作时间",dataIndex:"create_time",key:"create_time",width:200}],colorValue:""}),mounted(){this.init(),this.period=this.$route.query.period},methods:{init(){t.invoke(e.sqlitedbOperation,{action:"getDataDir"}).then((t=>{-1!=t.code?(this.data_dir=t.result,console.log("xxxxxx"),this.queryAllSum()):this.$message.error("请检查sqlite是否正确安装",5)}))},queryAllSum(){const l={action:"queryAllSum",ballDTO:{},period:this.period,ballType:this.ballType,zodiac:this.zodiac};t.invoke(e.ballSqliteOperation,l).then((t=>{this.allList=t.all_list,this.allSum=0,this.allList.forEach((t=>{this.allSum=parseInt(this.allSum)+parseInt(t.sum)}))}))},shengxiaoChange(){let t=0;this.allList.forEach((e=>{this.shengxiaoArr.length>0&&this.shengxiaoArr.forEach((l=>{l===e.zodiac&&(t+=e.sum)}))})),this.shengxiaoSum=t},typeChange2(){this.typeStr="";let t="";this.colorValue&&(this.addType=[],t=this.colorValue),"红"===t&&(t="red"),"蓝"===t&&(t="blue"),"绿"===t&&(t="green"),"单"===t&&(t=1),"双"===t&&(t=2),0===this.typeStr.length&&(this.typeStr=this.allList.filter((e=>e.color===t)).map((t=>t.ballNum)).join(", ")),0===this.typeStr.length&&(this.typeStr=this.allList.filter((e=>e.ballType===t)).map((t=>t.ballNum)).join(", "))},typeChange(){let t="";this.typeStr="",this.addType&&(this.colorValue="",t=this.addType),this.typeStr=this.allList.filter((e=>-1!==t.indexOf(e.zodiac))).map((t=>t.ballNum)).join(", ")},openDetail(l,a){const o={action:"queryDetailByNum",ballDTO:{period:this.period,ballNum:l}};t.invoke(e.ballSqliteOperation,o).then((t=>{this.detailList=t.all_list,console.log(this.detailList.length),0===this.detailList.length?this.amountStr="无":(this.amountStrArr=this.detailList.map((t=>t.amount)),this.amountStrArr.forEach((t=>{this.amountStr=t>0?this.amountStr+t+"+":this.amountStr.substring(0,this.amountStr.length-1)+t})),this.amountStr=this.amountStr+" = "+a)})),this.showDetail=!0},openDialog(t){this.operationBall.ballNum=t.ballNum,this.operationBall.operation=t.operation,this.showAddSub=!0,this.$nextTick((()=>{console.log(this.$refs.inputAmountRef),this.$refs.inputAmountRef.focus()}))},openBatch(){this.showBatch=!0},openBatch2(){this.showBatch2=!0},openHistory(){this.showHistory=!0;const l={action:"queryHistory",ballDTO:{period:this.period},period:this.period};t.invoke(e.ballSqliteOperation,l).then((t=>{this.historyDataList=t.all_list}))},returnInit(){this.$router.push({name:"Login"})},deleteAll(){var a;(a={title:"温馨提示",width:500,message:"是否确认删除本期数据？删除后不可恢复数据"},C(l({showCancelButton:!0},a))).then((()=>{const l={action:"deleteByPeriod",ballDTO:{ballNum:this.operationBall.ballNum,amount:this.operationBall.amount},period:this.period};t.invoke(e.ballSqliteOperation,l).then((t=>{this.queryAllSum()}))})).catch((()=>{}))},openType(){this.showType=!0},zhinengConfirm(){let l=this.amountText.split("各");if(l.length<=1||""===l[1])return void this.$message.error("智能加数失败：请检查你的公式是否正确！",1);let a=[],o=!1;if(/\d+\./.test(l[0])&&!o&&(a=l[0].split("."),o=!0),/\d+\*/.test(l[0])&&!o&&(a=l[0].split("*"),o=!0),/\d+\+/.test(l[0])&&!o&&(a=l[0].split("+"),o=!0),/\d+\-/.test(l[0])&&!o&&(a=l[0].split("-"),o=!0),/\d+\,/.test(l[0])&&!o&&(a=l[0].split(","),o=!0),/\d+，/.test(l[0])&&!o&&(a=l[0].split("，"),o=!0),!o)return void this.$message.error("智能加数失败：请检查你的公式是否正确！",1);if(isNaN(l[1]))return void this.$message.error("智能加数失败：请检查你的公式 各 后面的字符是否正确！",2);let i={action:"insertHistory",ballDTO:{desc:a.join(",")+" 加 "+l[1]+"元",period:this.period}};a.forEach((a=>{let o={action:"operationAmount",ballDTO:{ballNum:a,amount:l[1],period:this.period}};t.invoke(e.ballSqliteOperation,o).then((t=>{this.queryAllSum(),this.amountText=""}))})),t.invoke(e.ballSqliteOperation,i).then((t=>{})),this.$message.success("智能批量加数成功！",1)},amountConfirm(){let l=" 加 "+this.operationBall.amount+"元";"sub"===this.operationBall.operation&&(l=" 减 "+this.operationBall.amount+"元",this.operationBall.amount=-this.operationBall.amount);const a={action:"operationAmount",ballDTO:{ballNum:this.operationBall.ballNum,amount:this.operationBall.amount,period:this.period}};t.invoke(e.ballSqliteOperation,a).then((t=>{this.queryAllSum(),this.operationBall.amount="",this.$message.success("操作成功！",1)}));let o={action:"insertHistory",ballDTO:{desc:this.operationBall.ballNum+l,period:this.period}};t.invoke(e.ballSqliteOperation,o).then((t=>{}))},typeConfirm(){if(!this.typeStr)return void this.$message.error("请选择需要操作的类别！",1);let l=this.typeStr.split(", ");l.forEach((l=>{const a={action:"operationAmount",ballDTO:{ballNum:l,amount:this.typeAmount,period:this.period}};t.invoke(e.ballSqliteOperation,a).then((t=>{this.queryAllSum(),this.typeAmount="",this.addType="",this.showType=!1}))}));let a={action:"insertHistory",ballDTO:{desc:l.join(",")+" 加 "+this.typeAmount+"元",period:this.period}};t.invoke(e.ballSqliteOperation,a).then((t=>{})),this.$message.success("操作成功！",1)},batchConfirm(){if(0===this.numCheckValue.length||""===this.numCheckAmount)return void this.$message.error("数字未选择或者金额未填入",1);this.numCheckValue.forEach((l=>{const a={action:"operationAmount",ballDTO:{ballNum:l,amount:this.numCheckAmount,period:this.period}};t.invoke(e.ballSqliteOperation,a).then((t=>{this.queryAllSum(),this.numCheckAmount="",this.numCheckValue=[],this.showBatch2=!1}))}));let l={action:"insertHistory",ballDTO:{desc:this.numCheckValue.join(",")+" 加 "+this.numCheckAmount+"元",period:this.period}};t.invoke(e.ballSqliteOperation,l).then((t=>{})),this.$message.success("操作成功！",1)}}},[["render",function(t,e,l,a,o,i){const s=h("van-button"),u=h("itemCard"),r=h("a-input"),y=h("van-dialog"),k=h("a-textarea"),w=h("a-select"),C=h("a-radio-button"),S=h("a-radio-group"),O=h("a-modal"),A=h("a-table"),B=h("a-checkbox-group");return p(),d("div",T,[m("div",_,[m("div",N,[m("span",null,v(o.period)+"期总数：",1),m("span",null,v(o.allSum),1)]),m("div",q,[n(s,{class:"header-button",type:"primary",onClick:i.returnInit},{default:c((()=>[b("重新选择期数")])),_:1},8,["onClick"]),n(s,{class:"header-button",type:"primary",onClick:i.openBatch},{default:c((()=>[b("智能加数")])),_:1},8,["onClick"]),n(s,{class:"header-button",type:"primary",onClick:i.openType},{default:c((()=>[b("类别加数")])),_:1},8,["onClick"]),n(s,{class:"header-button",type:"primary",onClick:i.openHistory},{default:c((()=>[b("历史记录")])),_:1},8,["onClick"]),n(s,{class:"header-button",type:"primary",onClick:i.openBatch2},{default:c((()=>[b("批量添加")])),_:1},8,["onClick"]),n(s,{class:"header-button",type:"danger",onClick:i.deleteAll},{default:c((()=>[b("清空本期数据")])),_:1},8,["onClick"])])]),m("div",L,[(p(!0),d(f,null,g(o.allList,((t,e)=>(p(),x(u,{key:e,ballNum:t.ballNum,sum:t.sum,color:t.color,shengxiao:t.zodiac,onOpenDialog:i.openDialog,onOpenDetail:i.openDetail},null,8,["ballNum","sum","color","shengxiao","onOpenDialog","onOpenDetail"])))),128))]),n(y,{show:o.showAddSub,"onUpdate:show":e[1]||(e[1]=t=>o.showAddSub=t),title:"操作","show-cancel-button":"",onConfirm:i.amountConfirm},{default:c((()=>[m("div",$,[n(r,{autofocus:"true",ref:"inputAmountRef",value:o.operationBall.amount,"onUpdate:value":e[0]||(e[0]=t=>o.operationBall.amount=t),type:"number","addon-before":"金额"},null,8,["value"])])])),_:1},8,["show","onConfirm"]),n(y,{width:"800",show:o.showDetail,"onUpdate:show":e[2]||(e[2]=t=>o.showDetail=t),title:"详情","show-cancel-button":""},{default:c((()=>[m("div",z,[m("span",null,v(o.amountStr),1)])])),_:1},8,["show"]),n(y,{show:o.showBatch,"onUpdate:show":e[4]||(e[4]=t=>o.showBatch=t),title:"智能批量添加","show-cancel-button":"",width:"800",onConfirm:i.zhinengConfirm},{default:c((()=>[m("div",U,[n(k,{value:o.amountText,"onUpdate:value":e[3]||(e[3]=t=>o.amountText=t),placeholder:"例如：10.25.33.11.22各15"},null,8,["value"])])])),_:1},8,["show","onConfirm"]),n(O,{visible:o.showType,"onUpdate:visible":e[8]||(e[8]=t=>o.showType=t),title:"按类别加数(生肖和类别只能选一种操作)",onOk:i.typeConfirm,"ok-text":"确认","cancel-text":"取消"},{default:c((()=>[m("div",H,[n(w,{class:"header-button",mode:"multiple",value:o.addType,"onUpdate:value":e[5]||(e[5]=t=>o.addType=t),options:o.typeOptions,size:"large",placeholder:"请选择需要添加的生肖",style:{width:"200px","margin-right":"22px"},onChange:i.typeChange},null,8,["value","options","onChange"]),n(S,{style:{"margin-top":"24px"},value:o.colorValue,"onUpdate:value":e[6]||(e[6]=t=>o.colorValue=t),onChange:i.typeChange2,"button-style":"solid"},{default:c((()=>[n(C,{value:"红"},{default:c((()=>[b("红")])),_:1}),n(C,{value:"绿"},{default:c((()=>[b("绿")])),_:1}),n(C,{value:"蓝"},{default:c((()=>[b("蓝")])),_:1}),n(C,{value:"单"},{default:c((()=>[b("单")])),_:1}),n(C,{value:"双"},{default:c((()=>[b("双")])),_:1})])),_:1},8,["value","onChange"]),m("p",V,v(o.typeStr),1),n(r,{prefix:"￥",value:o.typeAmount,"onUpdate:value":e[7]||(e[7]=t=>o.typeAmount=t),style:{width:"200px"}},null,8,["value"])])])),_:1},8,["visible","onOk"]),n(O,{width:"800px",visible:o.showHistory,"onUpdate:visible":e[9]||(e[9]=t=>o.showHistory=t),title:"历史记录",onOk:e[10]||(e[10]=t=>o.showHistory=!1),"ok-text":"确认","cancel-text":"取消"},{default:c((()=>[m("div",j,[n(A,{dataSource:o.historyDataList,columns:o.columns},null,8,["dataSource","columns"])])])),_:1},8,["visible"]),n(O,{width:"550px",visible:o.showBatch2,"onUpdate:visible":e[13]||(e[13]=t=>o.showBatch2=t),title:"数字多选加数",onOk:i.batchConfirm,"ok-text":"确认","cancel-text":"取消"},{default:c((()=>[m("div",I,[n(B,{value:o.numCheckValue,"onUpdate:value":e[11]||(e[11]=t=>o.numCheckValue=t),name:"checkboxgroup",options:o.numOptions},null,8,["value","options"]),n(r,{prefix:"￥",value:o.numCheckAmount,"onUpdate:value":e[12]||(e[12]=t=>o.numCheckAmount=t),style:{width:"200px","margin-top":"24px"}},null,8,["value"])])])),_:1},8,["visible","onOk"])])}],["__scopeId","data-v-c4dca26d"]]);export{E as default};
